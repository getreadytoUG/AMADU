<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>아마두 로그인</title>
    <link rel="stylesheet" href="../css/background.css">
    <link rel="stylesheet" href="../css/login.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
    <script>
        // 페이지 로드 전 실행되어 JWT 가 유효하면 로그인 화면 넘기고 바로 메인 홈 화면으로 이동
        (function () {
            const userInfo = localStorage.getItem("userInfo");
            if (userInfo) {
                const item = JSON.parse(userInfo);
                const now = new Date();

                // 만료 여부 확인
                if (now.getTime() > item.expiry) {
                    localStorage.removeItem("userInfo");
                    localStorage.removeItem("key");
                    localStorage.removeItem("currentItem");
                    localStorage.removeItem("currentArea");
                    localStorage.removeItem("currentGrowDate");
                    localStorage.removeItem("7daysPrice");
                }
                // 만료 되지 않아을 경우 만료 일자를 갱신하고 바로 로그인 홈 화면으로 진입
                else {
                    const newExpiryTime = now.getTime() + (7 * 24 * 60 * 60 * 1000);
                    item.expiry = newExpiryTime;

                    localStorage.setItem("userInfo", JSON.stringify(item));

                    window.location.href = "./index.html";
                }

                // JWT 를 언제 갱신하고 언제 바꾸는지..?
            }
        })();
    </script>
</head>

<body>
    <header class="logo">
        <div>
            <p class="title mint">아마두</p>
            <p class="subtitle">&nbsp;AI기반 농산물 가격 예측 서비스</p>
        </div>
    </header>

    <div class="container">
        <div id="title">
            <p>로그인</p>
        </div>

        <form id="loginForm" method="#">
            <div class="form-group">
                <label for="userid">아이디</label><br>
                <input type="text" id="userid" name="userid" maxlength="20" required>
            </div>

            <div class="form-group">
                <label for="userpassword">비밀번호</label><br>
                <input type="password" id="userpassword" name="userpassword" minlength="4" required>
            </div>

            <button type="submit" class="login-btn" id="loginBt">
                <span>로그인</span>
            </button>

            <p class="subtitle ment">아직 회원가입을 하지 않으셨나요? <a href="./join.html">회원가입</a></p>


        </form>
    </div>
</body>
<script src="../js/login.js" defer></script>

</html>